<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ma bulle de recommandation - Réflexion</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body{margin:0;padding:0;font-family:Verdana,sans-serif;background:linear-gradient(to bottom,#5bc0eb,#20639b);height:100vh;overflow:hidden;position:relative;opacity:0;animation:fadeIn 0.5s ease forwards;}
    @keyframes fadeIn{from{opacity:0;}to{opacity:1;}}
    @keyframes fadeOut{from{opacity:1;}to{opacity:0;}}
    .fade-out{animation:fadeOut 0.5s ease forwards;}
    .container{display:flex;height:100%;padding:1rem;box-sizing:border-box;position:relative;z-index:1;gap:1rem;}
    .panel{flex:1;background:rgba(255,255,255,0.1);border-radius:8px;padding:1rem;color:#fff;overflow:auto;}
    h2{margin-top:0;font-size:1.3rem;}
    .card{background:rgba(255,255,255,0.1);border-radius:8px;padding:0.5rem;margin:0.5rem 0;}
    a{color:#fff;}
    .nav-bubble{position:absolute;top:1rem;width:30px;height:30px;background:rgba(255,255,255,0.2);border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;backdrop-filter:blur(6px);transition:background 0.2s;z-index:2;color:#fff;font-size:1rem;}
    .nav-bubble:hover{background:rgba(255,255,255,0.3);}
    .nav-left{right:70px;}
    .nav-right{right:20px;}
    .bubble-floating{position:absolute;border-radius:50%;background:rgba(255,255,255,0.1);animation:floatUp 30s linear infinite;pointer-events:none;backdrop-filter:blur(8px);z-index:0;}
    @keyframes floatUp{0%{bottom:-100px;transform:translateX(0);}100%{bottom:110%;transform:translateX(50px);}}
  </style>
</head>
<body>
  <div class="nav-bubble nav-left" onclick="navigate('page5.html')">◀</div>
  <div class="nav-bubble nav-right" onclick="navigate('index.html')">▶</div>
  <div class="container">
    <div class="panel">
      <h2>Erreurs</h2>
      <canvas id="catChart" height="150"></canvas>
      <canvas id="ageChart" height="150" style="margin-top:1rem;"></canvas>
    </div>
    <div class="panel">
      <h2>Réflexion</h2>
      <div class="card">Pourquoi plus d’erreurs sur certaines catégories ?</div>
      <div class="card">Comment notre dataset pourrait-il être biaisé ?</div>
      <div class="card">Que feriez-vous pour améliorer les données ?</div>
      <a href="https://fr.wikipedia.org/wiki/Biais_de_s%C3%A9lection" target="_blank">En savoir plus sur les biais de données</a>
    </div>
  </div>
  <div class="bubble-floating" style="left:10%;width:80px;height:80px;animation-delay:1s;"></div>
  <div class="bubble-floating" style="left:30%;width:60px;height:60px;animation-delay:5s;"></div>
  <div class="bubble-floating" style="left:50%;width:100px;height:100px;animation-delay:3s;"></div>
  <div class="bubble-floating" style="left:70%;width:50px;height:50px;animation-delay:7s;"></div>
  <div class="bubble-floating" style="left:90%;width:80px;height:80px;animation-delay:4s;"></div>
  <script>
    function navigate(url){document.body.classList.add('fade-out');document.body.addEventListener('animationend',()=>window.location.href=url,{once:true});}
    const stored=JSON.parse(localStorage.getItem('feedback')||'[]');
    const catErrors={};const ageErrors={'10-12':0,'13-14':0};
    stored.forEach(r=>{if(!r.correct){catErrors[r.category]=(catErrors[r.category]||0)+1;const range=r.age<=12?'10-12':'13-14';ageErrors[range]=(ageErrors[range]||0)+1;}});
    new Chart(document.getElementById('catChart'),{type:'bar',data:{labels:Object.keys(catErrors),datasets:[{label:'Erreurs',data:Object.values(catErrors),backgroundColor:'rgba(244,67,54,0.5)'}]},options:{scales:{y:{beginAtZero:true}}}});
    new Chart(document.getElementById('ageChart'),{type:'bar',data:{labels:Object.keys(ageErrors),datasets:[{label:'Erreurs',data:Object.values(ageErrors),backgroundColor:'rgba(244,67,54,0.5)'}]},options:{scales:{y:{beginAtZero:true}}}});
  </script>
</body>
</html>
